#!/bin/sh -e
#
# This script expects the WARD and ADDGUARDS environment variables to be set.

OUTFILE="$1" ; shift
TMPFILE=`mktemp -t XXXXXX` || exit 1

"$WARD" -suggest "$@" > "$TMPFILE"

# HACK: get last argument (at least when called from the GAP
# build system, the last argument is the name of the input file.
for last ; do
  :
done

cat > "$OUTFILE" <<EOF
/* This file was generated by Ward from $last */

EOF

"$ADDGUARDS" "$TMPFILE" "$last" >> "$OUTFILE"
