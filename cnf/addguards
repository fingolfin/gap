#!/bin/sh
# This script expects the WARD and ADDGUARDS environment variables to be set.

set -e

OUTFILE="$1" ; shift
INFILE="$1" ; shift
TMPFILE=`mktemp -t XXXXXX` || exit 1

"$WARD" -suggest -cpp "$@" -- "$INFILE" > "$TMPFILE"

cat > "$OUTFILE" <<EOF
/* This file was generated by Ward from $INFILE */

EOF

"$ADDGUARDS" "$TMPFILE" "$INFILE" >> "$OUTFILE"
